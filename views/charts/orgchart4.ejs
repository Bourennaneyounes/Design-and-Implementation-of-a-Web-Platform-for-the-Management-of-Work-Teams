 <!DOCTYPE html>

<html>
<head>
  
  <script src="https://kit.fontawesome.com/495f0538c0.js" crossorigin="anonymous"></script>

  <script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>
  <link rel="stylesheet" href="/stylesheets/lib/bootstrap.css">
  <link rel="stylesheet" href="/stylesheets/lib/semantic.min.css">
  <link href='/stylesheets/core_main.css' rel='stylesheet' />
  <link href='/stylesheets/daygrid_main.css' rel='stylesheet' />
  <link href='/stylesheets/timegrid_main.css' rel='stylesheet' />
  <link href='/stylesheets/list_main.css' rel='stylesheet' />
  <link rel="stylesheet" type="text/css" href="/stylesheets/colorpicker.css" />
  <link rel="stylesheet" href="/stylesheets/style1.css">
  <link href="/stylesheets/event.css" rel="stylesheet">
  <script src="/scripts/json-preview.js"></script>
  <link rel="stylesheet" href="/stylesheets/filesUploader.css">
  <link href='/stylesheets/profil.css' rel='stylesheet' />
  

  
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />




<script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.js" integrity="sha512-dqw6X88iGgZlTsONxZK9ePmJEFrmHwpuMrsUChjAw1mRUhUITE5QU9pkcSox+ynfLhL15Sv2al5A0LVyDCmtUw==" crossorigin="anonymous"></script>
  <!---->
      <meta charset="UTF-8">
  <title>Org Chart Editor</title>
  <meta name="description" content="An organization chart editor -- edit details and change relationships." />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Copyright 1998-2020 by Northwoods Software Corporation. -->

  <script src="/scripts/go.js"></script>
  <script src="/scripts/goSamples.js"></script>  <!-- this is only for the GoJS Samples framework -->
  
  <script type="text/javascript" src="/scripts/DataInspector.js"></script>
  <!--<script type="text/javascript" src="scripts/bootstarp.min.js"></script>-->
  <script type="text/javascript" src="scripts/highlight.js"></script>
  <!--<script type="text/javascript" src="scripts/jquery.min.js"></script>-->
  <!--<link rel="stylesheet" href="stylesheets/images">-->
  <link rel="stylesheet" href="/stylesheets/DataInspector.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/components/icon.min.css" integrity="sha512-8Tb+T7SKUFQWOPIQCaLDWWe1K/SY8hvHl7brOH8Nz5z1VT8fnf8B+9neoUzmFY3OzkWMMs3OjrwZALgB1oXFBg==" crossorigin="anonymous" />
  <script id="code">
    function init() {
     // if (window.goSamples) goSamples();  // init for these samples -- you don't need to call this
      var $ = go.GraphObject.make;  // for conciseness in defining templates

      myDiagram =
        $(go.Diagram, "myDiagramDiv", // must be the ID or reference to div
          {
            maxSelectionCount: 1, // users can select only one part at a time
            validCycle: go.Diagram.CycleDestinationTree, // make sure users can only create trees
            "clickCreatingTool.archetypeNodeData": { // allow double-click in background to create a new node
              name: "(new person)",
              title: "",
              comments: ""
            },
            "clickCreatingTool.insertPart": function(loc) {  // scroll to the new node
              var node = go.ClickCreatingTool.prototype.insertPart.call(this, loc);
              if (node !== null) {
                this.diagram.select(node);
                this.diagram.commandHandler.scrollToPart(node);
                this.diagram.commandHandler.editTextBlock(node.findObject("NAMETB"));
              }
              return node;
            },
            layout:
              $(go.TreeLayout,
                {
                  treeStyle: go.TreeLayout.StyleLastParents,
                  arrangement: go.TreeLayout.ArrangementHorizontal,
                  // properties for most of the tree:
                  angle: 90,
                  layerSpacing: 35,
                  // properties for the "last parents":
                  alternateAngle: 90,
                  alternateLayerSpacing: 35,
                  alternateAlignment: go.TreeLayout.AlignmentBus,
                  alternateNodeSpacing: 20
                }),
            "undoManager.isEnabled": true // enable undo & redo
          });

      // when the document is modified, add a "*" to the title and enable the "Save" button
      myDiagram.addDiagramListener("Modified", function(e) {
        var button = document.getElementById("SaveButton");
        if (button) button.disabled = !myDiagram.isModified;
        var idx = document.title.indexOf("*");
        if (myDiagram.isModified) {
          if (idx < 0) document.title += "*";
        } else {
          if (idx >= 0) document.title = document.title.substr(0, idx);
        }
      });

      // manage boss info manually when a node or link is deleted from the diagram
      myDiagram.addDiagramListener("SelectionDeleting", function(e) {
        var part = e.subject.first(); // e.subject is the myDiagram.selection collection,
        // so we'll get the first since we know we only have one selection
        myDiagram.startTransaction("clear boss");
        if (part instanceof go.Node) {
          var it = part.findTreeChildrenNodes(); // find all child nodes
          while (it.next()) { // now iterate through them and clear out the boss information
            var child = it.value;
            var bossText = child.findObject("boss"); // since the boss TextBlock is named, we can access it by name
            if (bossText === null) return;
            bossText.text = "";
          }
        } else if (part instanceof go.Link) {
          var child = part.toNode;
          var bossText = child.findObject("boss"); // since the boss TextBlock is named, we can access it by name
          if (bossText === null) return;
          bossText.text = "";
        }
        myDiagram.commitTransaction("clear boss");
      });

      var levelColors = ["#AC193D", "#2672EC", "#8C0095", "#5133AB",
        "#008299", "#D24726", "#008A00", "#094AB2"];

      // override TreeLayout.commitNodes to also modify the background brush based on the tree depth level
      myDiagram.layout.commitNodes = function() {
        go.TreeLayout.prototype.commitNodes.call(myDiagram.layout);  // do the standard behavior
        // then go through all of the vertexes and set their corresponding node's Shape.fill
        // to a brush dependent on the TreeVertex.level value
        myDiagram.layout.network.vertexes.each(function(v) {
          if (v.node) {
            var level = v.level % (levelColors.length);
            var color = levelColors[level];
            var shape = v.node.findObject("SHAPE");
            if (shape) shape.stroke = $(go.Brush, "Linear", { 0: color, 1: go.Brush.lightenBy(color, 0.05), start: go.Spot.Left, end: go.Spot.Right });
          }
        });
      };

      // when a node is double-clicked, add a child to it
      function nodeDoubleClick(e, obj) {
        var clicked = obj.part;
        if (clicked !== null) {
          var thisemp = clicked.data;
          myDiagram.startTransaction("add employee");
          var newemp = {
            name: "(new person)",
            title: "",
            comments: "",
            parent: thisemp.key
          };
          myDiagram.model.addNodeData(newemp);
          myDiagram.commitTransaction("add employee");
        }
      }

      // this is used to determine feedback during drags
      function mayWorkFor(node1, node2) {
        if (!(node1 instanceof go.Node)) return false;  // must be a Node
        if (node1 === node2) return false;  // cannot work for yourself
        if (node2.isInTreeOf(node1)) return false;  // cannot work for someone who works for you
        return true;
      }

      // This function provides a common style for most of the TextBlocks.
      // Some of these values may be overridden in a particular TextBlock.
      function textStyle() {
        return { font: "9pt  Segoe UI,sans-serif", stroke: "white" };
      }

      // This converter is used by the Picture.
      function findHeadShot(key) {
        if (key < 0 || key > 16) return "https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcQMDZH1hAZTs5H364fQPBj33spP6P8mi_CkfmHKcOUYArZ3LYTt"; // There are only 16 images on the server
        //return "images/HS" + key + ".jpg"
      }
      if(currentUser.admin===true){
      // define the Node template
      myDiagram.nodeTemplate =
        $(go.Node, "Auto",
          { doubleClick: nodeDoubleClick },
          { // handle dragging a Node onto a Node to (maybe) change the reporting relationship
            mouseDragEnter: function(e, node, prev) {
              var diagram = node.diagram;
              var selnode = diagram.selection.first();
              if (!mayWorkFor(selnode, node)) return;
              var shape = node.findObject("SHAPE");
              if (shape) {
                shape._prevFill = shape.fill;  // remember the original brush
                shape.fill = "darkred";
              }
            },
            mouseDragLeave: function(e, node, next) {
              var shape = node.findObject("SHAPE");
              if (shape && shape._prevFill) {
                shape.fill = shape._prevFill;  // restore the original brush
              }
            },
            mouseDrop: function(e, node) {
              var diagram = node.diagram;
              var selnode = diagram.selection.first();  // assume just one Node in selection
              if (mayWorkFor(selnode, node)) {
                // find any existing link into the selected node
                var link = selnode.findTreeParentLink();
                if (link !== null) {  // reconnect any existing link
                  link.fromNode = node;
                } else {  // else create a new link
                  diagram.toolManager.linkingTool.insertLink(node, node.port, selnode, selnode.port);
                }
              }
            }
          },
          // for sorting, have the Node.text be the data.name
          new go.Binding("text", "name"),
          // bind the Part.layerName to control the Node's layer depending on whether it isSelected
          new go.Binding("layerName", "isSelected", function(sel) { return sel ? "Foreground" : ""; }).ofObject(),
          // define the node's outer shape
          $(go.Shape, "Rectangle",
            {
              name: "SHAPE", fill: "#333333", stroke: 'white', strokeWidth: 3.5,
              // set the port properties:
              portId: "", fromLinkable: true, toLinkable: true, cursor: "pointer"
            }),
          $(go.Panel, "Horizontal",
            $(go.Picture,
              {
                name: "Picture",
                desiredSize: new go.Size(70, 70),
                margin: 1.5,
                
              },
              new go.Binding("source", "key", findHeadShot)),
            // define the panel where the text will appear
            $(go.Panel, "Table",
              {
                minSize: new go.Size(130, NaN),
                maxSize: new go.Size(150, NaN),
                margin: new go.Margin(6, 10, 0, 6),
                defaultAlignment: go.Spot.Left
              },
              $(go.RowColumnDefinition, { column: 2, width: 4 }),
              $(go.TextBlock, textStyle(),  // the name
                {
                  row: 0, column: 0, columnSpan: 5,
                  font: "12pt Segoe UI,sans-serif",
                  editable: true, isMultiline: false,
                  minSize: new go.Size(10, 16)
                },
                new go.Binding("text", "name").makeTwoWay()),
              $(go.TextBlock, "Title: ", textStyle(),
                { row: 1, column: 0 }),
              $(go.TextBlock, textStyle(),
                {
                  row: 1, column: 1, columnSpan: 4,
                  editable: true, isMultiline: false,
                  minSize: new go.Size(10, 14),
                  margin: new go.Margin(0, 0, 0, 3)
                },
                new go.Binding("text", "title").makeTwoWay()),
              $(go.TextBlock, textStyle(),
                { row: 2, column: 0 },
                new go.Binding("text", "key", function(v) { return "ID: " + v; })),
              $(go.TextBlock, textStyle(),
                { name: "boss", row: 2, column: 3, }, // we include a name so we can access this TextBlock when deleting Nodes/Links
                new go.Binding("text", "parent", function(v) { return "Boss: " + v; })),
              $(go.TextBlock, textStyle(),  // the comments
                {
                  row: 3, column: 0, columnSpan: 5,
                  font: "italic 9pt sans-serif",
                  wrap: go.TextBlock.WrapFit,
                  editable: true,  // by default newlines are allowed
                  minSize: new go.Size(10, 14)
                },
                new go.Binding("text", "comments").makeTwoWay())
            )  // end Table Panel
          ) // end Horizontal Panel
        );  // end Node
      }else{
        myDiagram.nodeTemplate =
        $(go.Node, "Auto",
         
          
          // for sorting, have the Node.text be the data.name
          new go.Binding("text", "name"),
          // bind the Part.layerName to control the Node's layer depending on whether it isSelected
          new go.Binding("layerName", "isSelected", function(sel) { return sel ? "Foreground" : ""; }).ofObject(),
          // define the node's outer shape
          $(go.Shape, "Rectangle",
            {
              name: "SHAPE", fill: "#333333", stroke: 'white', strokeWidth: 3.5,
              // set the port properties:
              portId: "", fromLinkable: true, toLinkable: true, cursor: "pointer"
            }),
          $(go.Panel, "Horizontal",
            $(go.Picture,
              {
                name: "Picture",
                desiredSize: new go.Size(70, 70),
                margin: 1.5,
                
              },
              new go.Binding("source", "key", findHeadShot)),
            // define the panel where the text will appear
            $(go.Panel, "Table",
              {
                minSize: new go.Size(130, NaN),
                maxSize: new go.Size(150, NaN),
                margin: new go.Margin(6, 10, 0, 6),
                defaultAlignment: go.Spot.Left
              },
              $(go.RowColumnDefinition, { column: 2, width: 4 }),
              $(go.TextBlock, textStyle(),  // the name
                {
                  row: 0, column: 0, columnSpan: 5,
                  font: "12pt Segoe UI,sans-serif",
                  editable: true, isMultiline: false,
                  minSize: new go.Size(10, 16)
                },
                new go.Binding("text", "name").makeTwoWay()),
              $(go.TextBlock, "Title: ", textStyle(),
                { row: 1, column: 0 }),
              $(go.TextBlock, textStyle(),
                {
                  row: 1, column: 1, columnSpan: 4,
                  editable: true, isMultiline: false,
                  minSize: new go.Size(10, 14),
                  margin: new go.Margin(0, 0, 0, 3)
                },
                new go.Binding("text", "title").makeTwoWay()),
              $(go.TextBlock, textStyle(),
                { row: 2, column: 0 },
                new go.Binding("text", "key", function(v) { return "ID: " + v; })),
              $(go.TextBlock, textStyle(),
                { name: "boss", row: 2, column: 3, }, // we include a name so we can access this TextBlock when deleting Nodes/Links
                new go.Binding("text", "parent", function(v) { return "Boss: " + v; })),
              $(go.TextBlock, textStyle(),  // the comments
                {
                  row: 3, column: 0, columnSpan: 5,
                  font: "italic 9pt sans-serif",
                  wrap: go.TextBlock.WrapFit,
                  editable: true,  // by default newlines are allowed
                  minSize: new go.Size(10, 14)
                },
                new go.Binding("text", "comments").makeTwoWay())
            )  // end Table Panel
          ) // end Horizontal Panel
        );  // end Node

      }
      // the context menu allows users to make a position vacant,
      // remove a role and reassign the subtree, or remove a department
      if(currentUser.admin===true){
        myDiagram.nodeTemplate.contextMenu =
      //console.log(JSON.parse(div.textContent).admin);
     // var currentUser = JSON.parse(div.textContent)

      //console.log(currentUser.admin)
      //console.log(JSON.parse(div.textContent));
      //var currentUser = JSON.parse(div.textContent)
     
       $("ContextMenu",
        
        
        $("ContextMenuButton",
            $(go.TextBlock, "Visit Profil"),
            {
              
              click: function(e, obj) {
                
                var node = obj.part.adornedPart;
               // console.log(JSON.parse(div.textContent)); 
                //console.log(node.jb);
                if (node !== null) {
                  window.location.href="/users/"+node.jb._id+"/profil";
                  
                }
              }
            }
          ),  
          
        $("ContextMenuButton",
            $(go.TextBlock, "Vacate Position"),
            {
       
              click: function(e, obj) {
            // if(currentUser.admin===true){
                  var node = obj.part.adornedPart;
                if (node !== null) {
                  var thisemp = node.data;
                  myDiagram.startTransaction("vacate");
                  // update the key, name, and comments
                  myDiagram.model.setDataProperty(thisemp, "name", "(Vacant)");
                  myDiagram.model.setDataProperty(thisemp, "comments", "");
                  myDiagram.commitTransaction("vacate");
                }
            // }
               
              }
            }
          ),
          $("ContextMenuButton",
            $(go.TextBlock, "Remove Role"),
            {
              click: function(e, obj) {
                // reparent the subtree to this node's boss, then remove the node
                var node = obj.part.adornedPart;
                if (node !== null) {
                  myDiagram.startTransaction("reparent remove");
                  var chl = node.findTreeChildrenNodes();
                  // iterate through the children and set their parent key to our selected node's parent key
                  while (chl.next()) {
                    var emp = chl.value;
                    myDiagram.model.setParentKeyForNodeData(emp.data, node.findTreeParentNode().data.key);
                  }
                  // and now remove the selected node itself
                  myDiagram.model.removeNodeData(node.data);
                  myDiagram.commitTransaction("reparent remove");
                }
              }
            }
          ),
          $("ContextMenuButton",
            $(go.TextBlock, "Remove Department"),
            {
              click: function(e, obj) {
                // remove the whole subtree, including the node itself
                var node = obj.part.adornedPart;
                if (node !== null) {
                  myDiagram.startTransaction("remove dept");
                  myDiagram.removeParts(node.findTreeParts());
                  myDiagram.commitTransaction("remove dept");
                }
              }
            }
          
        )
       
 
        );
      }else{
        myDiagram.nodeTemplate.contextMenu =
      //console.log(JSON.parse(div.textContent).admin);
     // var currentUser = JSON.parse(div.textContent)

      //console.log(currentUser.admin)
      //console.log(JSON.parse(div.textContent));
      //var currentUser = JSON.parse(div.textContent)
     
       $("ContextMenu",
        
        
        $("ContextMenuButton",
            $(go.TextBlock, "Visit Profil"),
            {
              
              click: function(e, obj) {
                
                var node = obj.part.adornedPart;
               // console.log(JSON.parse(div.textContent)); 
                //console.log(node.jb);
                if (node !== null) {
                  window.location.href="/users/"+node.jb._id+"/profil";
                  
                }
              }
            }
          ),  
         
       
 
        );
      }
   
       

      // define the Link template
      myDiagram.linkTemplate =
        $(go.Link, go.Link.Orthogonal,
          { corner: 5, relinkableFrom: true, relinkableTo: true },
          $(go.Shape, { strokeWidth: 1.5, stroke: "#F5F5F5" }));  // the link shape

      // read in the JSON-format data from the "mySavedModel" element
      load();

      if(currentUser.admin===true){
      // support editing the properties of the selected person in HTML
      if (window.Inspector) myInspector = new Inspector("myInspector", myDiagram,
        {
          
          properties: {
            "key": { readOnly: true },
            "id": { readOnly: true, },
            "_id": { readOnly: true, },
            "admin": { readOnly: true, },
            "contacts":{show : false},
            "messageNotifications":{show : false},
            "mailNotifications":{show : false},
            "bellNotifications":{show : false},
            "isLoggedUser":{show : false},
            "comments": { show : false},
            "positionName":{show : false},
            "events":{show : false},
            "sentProjects":{show : false},
            "assignedProjects":{show : false},
            "receivedProjects":{show : false},
            "sentMails":{show : false},
            "sentMailsStorage":{show : false},
            "usedSentMailsStorage":{show : false},
            "receivedMails":{show : false},
            "receivedMailsStorage":{show : false},
            "usedReceivedMailsStorage":{show : false},
            "sentMessages":{show : false},
            "receivedMessages":{show : false},
            "_w":{show : false},
            "path":{show : false},
            "__v":{show : false},
          }
        });
      }

      // Setup zoom to fit button
      
      document.getElementById('zoomToFit').addEventListener('click', function() {
        myDiagram.commandHandler.zoomToFit();
      });

      document.getElementById('centerRoot').addEventListener('click', function() {
        myDiagram.scale = 1;
        myDiagram.commandHandler.scrollToPart(myDiagram.findNodeForKey(1));
      });

    } // end init

    // Show the diagram's model in JSON format
    function save() {
      document.getElementById("mySavedModel").value = myDiagram.model.toJson();
      myDiagram.isModified = false;
    }
    function load() {
      myDiagram.model = go.Model.fromJson(document.getElementById("mySavedModel").value);
      // make sure new data keys are unique positive integers
      var lastkey = 1;
      myDiagram.model.makeUniqueKeyFunction = function(model, data) {
        var k = data.key || lastkey;
        while (model.findNodeDataForKey(k)) k++;
        data.key = lastkey = k;
        return k;
      };
    }
  </script>
  <link rel='stylesheet prefetch' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css'>
  <link rel='stylesheet prefetch' href='https://fonts.googleapis.com/css?family=Roboto'>
  <link rel="stylesheet" href="/stylesheets/lib/bootstrap.css">
  <link rel="stylesheet" href="/stylesheets/lib/semantic.min.css">
  <link rel="stylesheet" href="/stylesheets/orgchart.css">

</head>
<body onload="init()">
   <!-- user basic infos -->
   <input type="hidden"  id="userId" value="<%= user._id%>" style="background-color: chartreuse;">
   <input type="hidden"  id="userImg" value="<%= user.imageUrl%>" style="background-color: chartreuse;">
   <input type="hidden"  id="username" value="<%= user.username%>" style="background-color: chartreuse;">
 <!--   <nav id="mainNavbar" class="navbar navbar-dark navbar-expand-sm py-0">
     <div class="container">
         <a id="navBrand" href="" class="navbar-brand">Brand</a>
         <button class="navbar-toggler" data-toggle="collapse" data-target="#navLinks">
         <span><i class="fas fa-angle-double-down"></i></span>
         </button>
         <div class="collapse navbar-collapse" id="navbarSupportedContent">
             <ul class="navbar-nav mr-auto">
                 <div class="dropdown my-0 py-0">
                     <button class="dropbtn my-1 ml-3">Units</button>
                     <div class="dropdown-content">
                         <a class="dropdown-item" href="/orgchart/<%= currentUser._id%>">All Units</a>
                         <% units.forEach(function(unit){ %>
                           <a class="dropdown-item" href="/orgchart/<%= currentUser._id%>/units/<%= unit._id%>"><%= unit.value%></a>
                         <% }) %>
                     </div>
                   </div>
              </ul>
              <ul class="navbar-nav navbar-right">
                    <li class="nav-item mr-3">
                     <a class="nav-link" href="#"><i class="fa fa-user" aria-hidden="true"></i> Profil</a>
                    </li>
                    <%if(!currentUser){%>
                    <li class="nav-item">
                     <a class="nav-link" href="register">Sign In</a>
                    </li>
                    
                    <li class="nav-item">
                     <a class="nav-link" href="login">Login</a>
                    </li>
                 <%}else{%>
                    <li class="nav-item">
                     <a class="nav-link" href="/logout">Logout</a>
                    </li>
                    <%}%>
                 <li class="nav-item mr-3">
                  <a class="nav-link" href="/users/<%= currentUser._id%>/profil"><i class="fa fa-user" aria-hidden="true"></i></a>
                 </li>
                 <li class="nav-item mr-3">
                     <div id="msgNotificationsDropdown" class="notificationDropdown my-0 py-0">
                         <a class="nav-link"><i class="fas fa-comments"></i></a>
                         <div class="floating ui red label" style="top: 0em;">
                             <span id="msgNotifsCount">
                                 <%if(currentUser.messageNotifications.count > 0){%>
                                     <%=currentUser.messageNotifications.count%>
                                 <%}%>
                             </span>
                         </div>
                         <div id="msgNotificationsContent" class="notificationDropdownContent">
                             <%if(currentUser.messageNotifications.array.length > 0){%>
                                 <%currentUser.messageNotifications.array.forEach(function(notification){%>
                                     <%if(notification.count > 1){%>
                                         <a href="/users/<%=currentUser._id%>/contacts/<%=notification.senderId%>/chat"><strong class="bitraf mr-2"><i class="far fa-comment"></i></strong>You have received <strong class="bitraf" msgfrom="<%=notification.senderId%>"><%=notification.count%></strong> new private messages from <strong class="bitraf"><%=notification.senderUsername%></strong>.</a>
                                     <%}else{%>
                                         <a href="/users/<%=currentUser._id%>/contacts/<%=notification.senderId%>/chat"><strong class="bitraf mr-2"><i class="far fa-comment"></i></strong>You have received <strong class="bitraf" msgfrom="<%=notification.senderId%>">1</strong> new private message from <strong class="bitraf"><%=notification.senderUsername%></strong>.</a>
                                     <%}%>
                                 <%});%>
                             <%}else{%>
                                 <div id="msgEmptyNotifications" class="emptyNotifications">
                                     <span class="bitraf">Empty</span>
                                 </div>
                             <%}%>
                         </div>
                     </div>
                 </li>   
                 <li class="nav-item mr-3">
                     <div id="mailNotificationsDropdown" class="notificationDropdown my-0 py-0">
                         <a class="nav-link"><i class="fas fa-envelope"></i></a>
                         <div class="floating ui red label" style="top: 0em;">
                             <span id="mailNotifsCount">
                                 <%if(currentUser.mailNotifications.count > 0){%>
                                     <%=currentUser.mailNotifications.count%>
                                 <%}%>
                             </span>
                         </div>
                         <div id="mailNotificationsContent" class="notificationDropdownContent">
                             <%if(currentUser.mailNotifications.array.length > 0){%>
                                 <%currentUser.mailNotifications.array.forEach(function(notification){%>
                                     <%if(notification.notifType == 'newMail'){%>
                                         <%if(notification.count > 1){%>
                                             <a href="/users/<%=currentUser._id%>/mails/received"><strong class="bitraf mr-2"><i class="far fa-envelope"></i></strong>You have received <strong class="bitraf" mailfrom="<%=notification.senderId%>"><%=notification.count%></strong> new mails from <strong class="bitraf"><%=notification.senderUsername%></strong>.</a>
                                         <%}else{%>
                                             <a href="/users/<%=currentUser._id%>/mails/received/<%=notification.mailId%>/content"><strong class="bitraf mr-2"><i class="far fa-envelope"></i></strong>You have received <strong class="bitraf" mailfrom="<%=notification.senderId%>">1</strong> new mail from <strong class="bitraf"><%=notification.senderUsername%></strong>.</a>
                                         <%}%>
                                     <%}else if(notification.notifType == 'newReply'){%>
                                         <%if(notification.parentMailSender == user._id){%>
                                             <a href="/users/<%=currentUser._id%>/mails/received/<%=notification.replyId%>/content"><strong class="bitraf mr-2"><i class="far fa-envelope"></i></strong><strong class="bitraf"><%=notification.senderUsername%></strong> has replied to the sent mail <strong class="bitraf">"<%=notification.parentMailTitle%>"</strong>.</a>
                                         <%}else{%>
                                             <a href="/users/<%=currentUser._id%>/mails/received/<%=notification.replyId%>/content"><strong class="bitraf mr-2"><i class="far fa-envelope"></i></strong><strong class="bitraf"><%=notification.senderUsername%></strong> has replied to the received mail <strong class="bitraf">"<%=notification.parentMailTitle%>"</strong>.</a>
                                         <%}%>
                                     <%}else if(notification.notifType == 'mailSendFailed'){%>
                                         <%if(notification.senderId == user._id){%>
                                             <a><span class="bitraf mr-2"><i class="fas fa-exclamation-triangle"></i></span><strong class="bitraf"><%= notification.userThatDidNotReceiveUsername%></strong> was not able to receive your mail <strong class="bitraf">"<%= notification.mailTitle%>"</strong> due to his full storage.</a>
                                         <%}else{%>
                                             <a href="/users/<%=currentUser._id%>/mails/received"><span class="bitraf mr-2"><i class="fas fa-exclamation-triangle"></i></span> you were not able to receive a mail from <strong class="bitraf"><%=notification.senderUsername%></strong> at <strong class="bitraf">"<%=notification.at%>"</strong> due to your full storage.</a>
                                         <%}%>
                                     <%}else if(notification.notifType == 'notAbleToSendMailCuzFullSentMailsStorage'){%>
                                         <a href="/users/<%=currentUser._id%>/mails/sent"><span class="bitraf mr-2"><i class="fas fa-exclamation-triangle"></i></span> the mail <strong class="bitraf">"<%=notification.mailTitle%>"</strong> was not send due to your full sent mails storage.</a>
                                     <%}else if(notification.notifType == 'almostFullReceivedMailsStorage'){%>
                                         <a href="/users/<%=currentUser._id%>/mails/received"><span class="bitraf mr-2"><i class="fas fa-exclamation-triangle"></i></span> your received mails storage is almost full ,their is a risk of not being able to receive large mails in the future.</a>
                                     <%}else if(notification.notifType == 'almostFullSentMailsStorage'){%>
                                         <a href="/users/<%=currentUser._id%>/mails/sent"><span class="bitraf mr-2"><i class="fas fa-exclamation-triangle"></i></span> your sent mails storage is almost full ,their is a risk of not being able to send large mails in the future.</a>
                                     <%}%>
                                 <%});%>
                             <%}else{%>
                                 <div id="mailEmptyNotifications" class="emptyNotifications">
                                     <span class="bitraf">Empty</span>
                                 </div>
                             <%}%>
                         </div>
                     </div>
                 </li>
                 <li class="nav-item mr-3">
                     <div id="bellNotificationsDropdown" class="notificationDropdown my-0 py-0">
                         <a class="nav-link"><i class="fas fa-bell"></i></a>
                         <div class="floating ui red label" style="top: 0em;">
                             <span id="bellNotifsCount">
                                 <%if(currentUser.bellNotifications.count > 0){%>
                                     <%=currentUser.bellNotifications.count%>
                                 <%}%>
                             </span>
                         </div>
                         <div id="bellNotificationsContent" class="notificationDropdownContent">
                             <%if(currentUser.bellNotifications.array.length > 0){%>
                                 <%currentUser.bellNotifications.array.forEach(function(notification){%>
                                     <%if(notification.notifType == 'receivedProject'){%>
                                         <%if(notification.count > 1){%>
                                             <a href="/users/<%=currentUser._id%>/projects/received"><strong class="bitraf mr-2"><i class="fas fa-clipboard-list"></i></strong>You have received <strong class="bitraf" projectType="received"><%=notification.count%></strong> new projects.</a>
                                         <%}else{%>
                                             <a href="/users/<%=currentUser._id%>/projects/received/<%=notification.projectId%>/detail"><strong class="bitraf mr-2"><i class="fas fa-clipboard-list"></i></strong>You have received <strong class="bitraf" projectType="received">1</strong> new project at <strong class="bitraf"><%=notification.at%></strong>.</a>
                                         <%}%>
                                     <%}else if(notification.notifType == 'assignedProject'){%>
                                         <%if(notification.count > 1){%>
                                             <a href="/users/<%=currentUser%>/projects/assigned"><strong class="bitraf mr-2"><i class="fas fa-clipboard-list"></i></strong>You have been assigned to <strong class="bitraf" projectType="assigned"><%=notification.count%></strong> projects.</a>
                                         <%}else{%>
                                             <a href="/users/<%=currentUser%>/projects/assigned/<%=notification.projectId%>/detail"><strong class="bitraf mr-2"><i class="fas fa-clipboard-list"></i></strong>You have been assigned to <strong class="bitraf" projectType="received">1</strong> project at <strong class="bitraf"><%=notification.at%></strong>.</a>
                                         <%}%>
                                     <%}else if(notification.notifType == 'updateProject'){%>
                                         <%if(notification.projectType == 'assigned'){%>
                                             <a href="/users/<%=currentUser%>/projects/assigned/<%=notification.projectId%>/detail"><strong class="bitraf mr-2"><i class="fas fa-exclamation-circle"></i></strong> <strong class="bitraf"><%=notification.username%></strong> has updated the project <strong class="bitraf">"<%=notification.projectTitle%>"</strong> at <strong class="bitraf"><%=notification.at%></strong>.</a>
                                         <%}else{%>
                                             <a href="/users/<%=currentUser%>/projects/received/<%=notification.projectId%>/detail"><strong class="bitraf mr-2"><i class="fas fa-exclamation-circle"></i></strong> <strong class="bitraf"><%=notification.username%></strong> has updated the project <strong class="bitraf">"<%=notification.projectTitle%>"</strong> at <strong class="bitraf"><%=notification.at%></strong>.</a>
                                         <%}%>
                                     <%}else if(notification.notifType == 'unassignProject'){%>
                                         <a><strong class="bitraf mr-2"><i class="fas fa-exclamation-circle"></i></strong> <strong class="bitraf"><%=notification.username%></strong> has unassigned the project <strong class="bitraf">"<%=notification.projectTitle%>"</strong> at <strong class="bitraf"><%=notification.at%></strong>.</a>
                                     <%}else if(notification.notifType == 'newEvent'){%>
                                         <%if(notification.count > 1){%>
                                             <a href="/users/<%=currentUser._id%>/events"><strong class="bitraf mr-2"><i class="far fa-star"></i></strong> <strong class="bitraf"><%=notification.plannerUsername%></strong> has planned <span class="bitraf" eventFrom="<%=notification.plannerId%>"><%=notification.count%></span> events for you.</a>
                                         <%}else{%>
                                             <a href="<%=notification.url%>"><strong class="bitraf mr-2"><i class="far fa-star"></i></strong> <strong class="bitraf"><%=notification.plannerUsername%></strong> has planned <span class="bitraf" eventFrom="<%=notification.plannerId%>">1</span> event <strong class="bitraf">"<%=notification.eventTitle%>"</strong> for you at <strong class="bitraf"><%=notification.at%></strong>.</a>
                                         <%}%>
                                     <%}else if(notification.notifType == 'eventUpdate'){%>
                                         <a href="<%=notification.url%>"><strong class="bitraf mr-2"><i class="fas fa-exclamation-circle"></i></strong> <strong class="bitraf"><%=notification.plannerUsername%></strong> has updated <strong class="bitraf">"<%=notification.eventTitle%>"</strong> at <strong class="bitraf"><%=notification.at%></strong>.</a>
                                     <%}else if(notification.notifType == 'eventCancellation'){%>
                                         <a><strong class="bitraf mr-2"><i class="fas fa-exclamation-circle"></i></strong> <strong class="bitraf"><%=notification.plannerUsername%></strong> has canceled your <strong class="bitraf">"<%=notification.eventTitle%>"</strong> at <strong class="bitraf"><%=notification.at%></strong>.</a>
                                     <%}else if(notification.notifType == 'projectDiscussion'){%>
                                         <%if(notification.count > 1){%>
                                             <a href="/users/<%=user._id%>/projects/<%=notification.projectType%>/<%=notification.projectId%>/discussion"><strong class="bitraf mr-2"><i class="far fa-comments"></i></strong> <strong class="bitraf" discussionOf="<%=notification.projectId%>"><%=notification.count%></strong> new messages in <strong class="bitraf"><%=notification.projectTitle%></strong>'s group discussion.</a>
                                         <%}else{%>
                                             <a href="/users/<%=user._id%>/projects/<%=notification.projectType%>/<%=notification.projectId%>/discussion"><strong class="bitraf mr-2"><i class="far fa-comments"></i></strong> <strong class="bitraf" discussionOf="<%=notification.projectId%>">1</strong> new message in <strong class="bitraf"><%=notification.projectTitle%></strong>'s group discussion.</a>
                                         <%}%>
                                     <%}%>
                                 <%});%>
                             <%}else{%>
                                 <div id="bellEmptyNotifications" class="emptyNotifications">
                                     <span class="bitraf">Empty</span>
                                 </div>
                             <%}%>
                         </div>
                     </div>
                 </li>
                
              </ul>
           </div>
     </div>
 </nav> -->
  
   <!-- ///////////////////////////////////////// version 1 //////////////////////////////////////////////////////////////////// -->
  
 <!-- <div class="container my-5">
       <div class="ui grid">  -->

           <!-- MENU -->
          <!--  <div class="three wide column p-0">
             <div id="menu" class="ui vertical fluid tabular menu">
               <a id="showProfil" class="item menuItem" href="/users/<%= user._id%>/profil">
                   Profil
               </a>
               <%if(currentUser && user._id.equals(currentUser._id)){%>
                   
               <a id="showContacts" class="item menuItem" href="/users/<%= user._id%>/contacts">
                   Contacts
               </a>
               <%}%>
               <a id="showCalendar" class="item menuItem" href="/users/<%= user._id%>/events/calendar">
                   Calendar
              
              <a id="showProjects" class="item menuItem d-none" href="/users/<%= user._id%>/projects/assigned">
               Projects
           </a>
               <%if(currentUser && user._id.equals(currentUser._id)){%>
               <a id="showProjects" class="item menuItem" href="/users/<%= user._id%>/projects/assigned">
                   Projects
               </a>
               <%}%>
               <%if(currentUser && user._id.equals(currentUser._id)){%>
               <a id="showMails" class="item menuItem" href="/users/<%= user._id%>/mails/received">
                   Mails
               </a>
               <%}%>
             </div>
           </div> -->
         
           <!-- CONTENTS -->
          
             <!-- <div id="thirteen" class="thirteen wide stretched column p-0" >
                <div id="contentContainer" class="ui segment m-0">  -->
          

     <!--////////////////////////////// fin version 1   //////////////////////////////////////////////////////////////////////  -->

     <!-- ///////////////////////////////// vesrion 2 //////////////////////////////////////////////////////////////////////-->
    

     <!-- <div class="ui grid " >
       <div class="sixteen wide column pb-0">
         <nav id="mainNavbar" class="navbar navbar-dark navbar-expand-sm py-0">
           <div class="container">
               <a id="navBrand" href="" class="navbar-brand">Brand</a>
               <button class="navbar-toggler" data-toggle="collapse" data-target="#navLinks">
               <span><i class="fas fa-angle-double-down"></i></span>
               </button>
               <div class="collapse navbar-collapse" id="navbarSupportedContent">
                   <ul class="navbar-nav mr-auto">
                       <div class="dropdown my-0 py-0">
                           <button class="dropbtn my-1 ml-3">Units</button>
                           <div class="dropdown-content">
                               <a class="dropdown-item" href="/orgchart/<%= currentUser._id%>">All Units</a>
                               <% units.forEach(function(unit){ %>
                                 <a class="dropdown-item" href="/orgchart/<%= currentUser._id%>/units/<%= unit._id%>"><%= unit.value%></a>
                               <% }) %>
                           </div>
                         </div>
                    </ul>
                    <ul class="navbar-nav navbar-right">
                          <li class="nav-item mr-3">
                           <a class="nav-link" href="#"><i class="fa fa-user" aria-hidden="true"></i> Profil</a>
                          </li>
                          <%if(!currentUser){%>
                          <li class="nav-item">
                           <a class="nav-link" href="register">Sign In</a>
                          </li>
                          
                          <li class="nav-item">
                           <a class="nav-link" href="login">Login</a>
                          </li>
                       <%}else{%>
                          <li class="nav-item">
                           <a class="nav-link" href="/logout">Logout</a>
                          </li>
                          <%}%>
                       <li class="nav-item mr-3">
                        <a class="nav-link" href="/users/<%= currentUser._id%>/profil"><i class="fa fa-user" aria-hidden="true"></i></a>
                       </li>
                       <li class="nav-item mr-3">
                           <div id="msgNotificationsDropdown" class="notificationDropdown my-0 py-0">
                               <a class="nav-link"><i class="fas fa-comments"></i></a>
                               <div class="floating ui red label" style="top: 0em;">
                                   <span id="msgNotifsCount">
                                       <%if(currentUser.messageNotifications.count > 0){%>
                                           <%=currentUser.messageNotifications.count%>
                                       <%}%>
                                   </span>
                               </div>
                               <div id="msgNotificationsContent" class="notificationDropdownContent">
                                   <%if(currentUser.messageNotifications.array.length > 0){%>
                                       <%currentUser.messageNotifications.array.forEach(function(notification){%>
                                           <%if(notification.count > 1){%>
                                               <a href="/users/<%=currentUser._id%>/contacts/<%=notification.senderId%>/chat"><strong class="bitraf mr-2"><i class="far fa-comment"></i></strong>You have received <strong class="bitraf" msgfrom="<%=notification.senderId%>"><%=notification.count%></strong> new private messages from <strong class="bitraf"><%=notification.senderUsername%></strong>.</a>
                                           <%}else{%>
                                               <a href="/users/<%=currentUser._id%>/contacts/<%=notification.senderId%>/chat"><strong class="bitraf mr-2"><i class="far fa-comment"></i></strong>You have received <strong class="bitraf" msgfrom="<%=notification.senderId%>">1</strong> new private message from <strong class="bitraf"><%=notification.senderUsername%></strong>.</a>
                                           <%}%>
                                       <%});%>
                                   <%}else{%>
                                       <div id="msgEmptyNotifications" class="emptyNotifications">
                                           <span class="bitraf">Empty</span>
                                       </div>
                                   <%}%>
                               </div>
                           </div>
                       </li>   
                       <li class="nav-item mr-3">
                           <div id="mailNotificationsDropdown" class="notificationDropdown my-0 py-0">
                               <a class="nav-link"><i class="fas fa-envelope"></i></a>
                               <div class="floating ui red label" style="top: 0em;">
                                   <span id="mailNotifsCount">
                                       <%if(currentUser.mailNotifications.count > 0){%>
                                           <%=currentUser.mailNotifications.count%>
                                       <%}%>
                                   </span>
                               </div>
                               <div id="mailNotificationsContent" class="notificationDropdownContent">
                                   <%if(currentUser.mailNotifications.array.length > 0){%>
                                       <%currentUser.mailNotifications.array.forEach(function(notification){%>
                                           <%if(notification.notifType == 'newMail'){%>
                                               <%if(notification.count > 1){%>
                                                   <a href="/users/<%=currentUser._id%>/mails/received"><strong class="bitraf mr-2"><i class="far fa-envelope"></i></strong>You have received <strong class="bitraf" mailfrom="<%=notification.senderId%>"><%=notification.count%></strong> new mails from <strong class="bitraf"><%=notification.senderUsername%></strong>.</a>
                                               <%}else{%>
                                                   <a href="/users/<%=currentUser._id%>/mails/received/<%=notification.mailId%>/content"><strong class="bitraf mr-2"><i class="far fa-envelope"></i></strong>You have received <strong class="bitraf" mailfrom="<%=notification.senderId%>">1</strong> new mail from <strong class="bitraf"><%=notification.senderUsername%></strong>.</a>
                                               <%}%>
                                           <%}else if(notification.notifType == 'newReply'){%>
                                               <%if(notification.parentMailSender == user._id){%>
                                                   <a href="/users/<%=currentUser._id%>/mails/received/<%=notification.replyId%>/content"><strong class="bitraf mr-2"><i class="far fa-envelope"></i></strong><strong class="bitraf"><%=notification.senderUsername%></strong> has replied to the sent mail <strong class="bitraf">"<%=notification.parentMailTitle%>"</strong>.</a>
                                               <%}else{%>
                                                   <a href="/users/<%=currentUser._id%>/mails/received/<%=notification.replyId%>/content"><strong class="bitraf mr-2"><i class="far fa-envelope"></i></strong><strong class="bitraf"><%=notification.senderUsername%></strong> has replied to the received mail <strong class="bitraf">"<%=notification.parentMailTitle%>"</strong>.</a>
                                               <%}%>
                                           <%}else if(notification.notifType == 'mailSendFailed'){%>
                                               <%if(notification.senderId == user._id){%>
                                                   <a><span class="bitraf mr-2"><i class="fas fa-exclamation-triangle"></i></span><strong class="bitraf"><%= notification.userThatDidNotReceiveUsername%></strong> was not able to receive your mail <strong class="bitraf">"<%= notification.mailTitle%>"</strong> due to his full storage.</a>
                                               <%}else{%>
                                                   <a href="/users/<%=currentUser._id%>/mails/received"><span class="bitraf mr-2"><i class="fas fa-exclamation-triangle"></i></span> you were not able to receive a mail from <strong class="bitraf"><%=notification.senderUsername%></strong> at <strong class="bitraf">"<%=notification.at%>"</strong> due to your full storage.</a>
                                               <%}%>
                                           <%}else if(notification.notifType == 'notAbleToSendMailCuzFullSentMailsStorage'){%>
                                               <a href="/users/<%=currentUser._id%>/mails/sent"><span class="bitraf mr-2"><i class="fas fa-exclamation-triangle"></i></span> the mail <strong class="bitraf">"<%=notification.mailTitle%>"</strong> was not send due to your full sent mails storage.</a>
                                           <%}else if(notification.notifType == 'almostFullReceivedMailsStorage'){%>
                                               <a href="/users/<%=currentUser._id%>/mails/received"><span class="bitraf mr-2"><i class="fas fa-exclamation-triangle"></i></span> your received mails storage is almost full ,their is a risk of not being able to receive large mails in the future.</a>
                                           <%}else if(notification.notifType == 'almostFullSentMailsStorage'){%>
                                               <a href="/users/<%=currentUser._id%>/mails/sent"><span class="bitraf mr-2"><i class="fas fa-exclamation-triangle"></i></span> your sent mails storage is almost full ,their is a risk of not being able to send large mails in the future.</a>
                                           <%}%>
                                       <%});%>
                                   <%}else{%>
                                       <div id="mailEmptyNotifications" class="emptyNotifications">
                                           <span class="bitraf">Empty</span>
                                       </div>
                                   <%}%>
                               </div>
                           </div>
                       </li>
                       <li class="nav-item mr-3">
                           <div id="bellNotificationsDropdown" class="notificationDropdown my-0 py-0">
                               <a class="nav-link"><i class="fas fa-bell"></i></a>
                               <div class="floating ui red label" style="top: 0em;">
                                   <span id="bellNotifsCount">
                                       <%if(currentUser.bellNotifications.count > 0){%>
                                           <%=currentUser.bellNotifications.count%>
                                       <%}%>
                                   </span>
                               </div>
                               <div id="bellNotificationsContent" class="notificationDropdownContent">
                                   <%if(currentUser.bellNotifications.array.length > 0){%>
                                       <%currentUser.bellNotifications.array.forEach(function(notification){%>
                                           <%if(notification.notifType == 'receivedProject'){%>
                                               <%if(notification.count > 1){%>
                                                   <a href="/users/<%=currentUser._id%>/projects/received"><strong class="bitraf mr-2"><i class="fas fa-clipboard-list"></i></strong>You have received <strong class="bitraf" projectType="received"><%=notification.count%></strong> new projects.</a>
                                               <%}else{%>
                                                   <a href="/users/<%=currentUser._id%>/projects/received/<%=notification.projectId%>/detail"><strong class="bitraf mr-2"><i class="fas fa-clipboard-list"></i></strong>You have received <strong class="bitraf" projectType="received">1</strong> new project at <strong class="bitraf"><%=notification.at%></strong>.</a>
                                               <%}%>
                                           <%}else if(notification.notifType == 'assignedProject'){%>
                                               <%if(notification.count > 1){%>
                                                   <a href="/users/<%=currentUser%>/projects/assigned"><strong class="bitraf mr-2"><i class="fas fa-clipboard-list"></i></strong>You have been assigned to <strong class="bitraf" projectType="assigned"><%=notification.count%></strong> projects.</a>
                                               <%}else{%>
                                                   <a href="/users/<%=currentUser%>/projects/assigned/<%=notification.projectId%>/detail"><strong class="bitraf mr-2"><i class="fas fa-clipboard-list"></i></strong>You have been assigned to <strong class="bitraf" projectType="received">1</strong> project at <strong class="bitraf"><%=notification.at%></strong>.</a>
                                               <%}%>
                                           <%}else if(notification.notifType == 'updateProject'){%>
                                               <%if(notification.projectType == 'assigned'){%>
                                                   <a href="/users/<%=currentUser%>/projects/assigned/<%=notification.projectId%>/detail"><strong class="bitraf mr-2"><i class="fas fa-exclamation-circle"></i></strong> <strong class="bitraf"><%=notification.username%></strong> has updated the project <strong class="bitraf">"<%=notification.projectTitle%>"</strong> at <strong class="bitraf"><%=notification.at%></strong>.</a>
                                               <%}else{%>
                                                   <a href="/users/<%=currentUser%>/projects/received/<%=notification.projectId%>/detail"><strong class="bitraf mr-2"><i class="fas fa-exclamation-circle"></i></strong> <strong class="bitraf"><%=notification.username%></strong> has updated the project <strong class="bitraf">"<%=notification.projectTitle%>"</strong> at <strong class="bitraf"><%=notification.at%></strong>.</a>
                                               <%}%>
                                           <%}else if(notification.notifType == 'unassignProject'){%>
                                               <a><strong class="bitraf mr-2"><i class="fas fa-exclamation-circle"></i></strong> <strong class="bitraf"><%=notification.username%></strong> has unassigned the project <strong class="bitraf">"<%=notification.projectTitle%>"</strong> at <strong class="bitraf"><%=notification.at%></strong>.</a>
                                           <%}else if(notification.notifType == 'newEvent'){%>
                                               <%if(notification.count > 1){%>
                                                   <a href="/users/<%=currentUser._id%>/events"><strong class="bitraf mr-2"><i class="far fa-star"></i></strong> <strong class="bitraf"><%=notification.plannerUsername%></strong> has planned <span class="bitraf" eventFrom="<%=notification.plannerId%>"><%=notification.count%></span> events for you.</a>
                                               <%}else{%>
                                                   <a href="<%=notification.url%>"><strong class="bitraf mr-2"><i class="far fa-star"></i></strong> <strong class="bitraf"><%=notification.plannerUsername%></strong> has planned <span class="bitraf" eventFrom="<%=notification.plannerId%>">1</span> event <strong class="bitraf">"<%=notification.eventTitle%>"</strong> for you at <strong class="bitraf"><%=notification.at%></strong>.</a>
                                               <%}%>
                                           <%}else if(notification.notifType == 'eventUpdate'){%>
                                               <a href="<%=notification.url%>"><strong class="bitraf mr-2"><i class="fas fa-exclamation-circle"></i></strong> <strong class="bitraf"><%=notification.plannerUsername%></strong> has updated <strong class="bitraf">"<%=notification.eventTitle%>"</strong> at <strong class="bitraf"><%=notification.at%></strong>.</a>
                                           <%}else if(notification.notifType == 'eventCancellation'){%>
                                               <a><strong class="bitraf mr-2"><i class="fas fa-exclamation-circle"></i></strong> <strong class="bitraf"><%=notification.plannerUsername%></strong> has canceled your <strong class="bitraf">"<%=notification.eventTitle%>"</strong> at <strong class="bitraf"><%=notification.at%></strong>.</a>
                                           <%}else if(notification.notifType == 'projectDiscussion'){%>
                                               <%if(notification.count > 1){%>
                                                   <a href="/users/<%=user._id%>/projects/<%=notification.projectType%>/<%=notification.projectId%>/discussion"><strong class="bitraf mr-2"><i class="far fa-comments"></i></strong> <strong class="bitraf" discussionOf="<%=notification.projectId%>"><%=notification.count%></strong> new messages in <strong class="bitraf"><%=notification.projectTitle%></strong>'s group discussion.</a>
                                               <%}else{%>
                                                   <a href="/users/<%=user._id%>/projects/<%=notification.projectType%>/<%=notification.projectId%>/discussion"><strong class="bitraf mr-2"><i class="far fa-comments"></i></strong> <strong class="bitraf" discussionOf="<%=notification.projectId%>">1</strong> new message in <strong class="bitraf"><%=notification.projectTitle%></strong>'s group discussion.</a>
                                               <%}%>
                                           <%}%>
                                       <%});%>
                                   <%}else{%>
                                       <div id="bellEmptyNotifications" class="emptyNotifications">
                                           <span class="bitraf">Empty</span>
                                       </div>
                                   <%}%>
                               </div>
                           </div>
                       </li>
                      
                    </ul>
                 </div>
           </div>
       </nav>
   
       </div>
       <div class="two wide column pt-0 pb-0" style="margin-right: 2px;">
         <div class="ui vertical inverted menu" style="height: 100%;">

           <div class="item">
             
             <a href="/"><b>Society Name</b></a>
           </div>
           
           <a class="item" href="/orgchart/<%= currentUser._id%>">
             <b>Organigram</b>
           </a>
           
           <div class="item">
             <div class="header">
               
                 Profil
               
             </div>
             <div class="menu" id="showProfil">
               <a  class="item" href="/users/<%= user._id%>/profil">
                 Show Profil
               </a>
                 <a class="item" href="/users/<%= currentUser._id%>/units">
                   Units Management
                 </a>
               
                 <a class="item" href="/users/<%= currentUser._id%>/profil/gestionUsers">
                   Users Management
                 </a>
               
             </div>
           </div>
           <div class="item">
             <div class=" header">
               
               Contacts

             </div>
             <div class="menu" id="showContacts">
               
                 <a class="item"  href="/users/<%= user._id%>/contacts">
                   show Contacts
                   
                 </a>
               
             </div>
           </div>
           <div class="item">
             <div class="header">
               
                 Calendar
             </div>
             <div class="menu" id="showCalendar">
               
                 <a class="item"   href="/users/<%= user._id%>/events/calendar">
                  Show Calendar
                   
                 </a>
               
                 <a class="item"  href="/users/<%= user._id%>/events/planned">
                   Planned Events
                   
                 </a>
               
             </div>
           </div>
           <div class="item">
             <div class=" header" id="showProjects" >

                 Tasks
             
             </div>
             <div class="menu">
               
                 <a class="item" href="/users/<%= user._id%>/projects/received">
                   Received Tasks
                   
                 </a>
               
                 <a class="item" href="/users/<%= user._id%>/projects/assigned">
                   Assigned Tasks
                   
                 </a>
               
                 <a class="item" href="/users/<%= user._id%>/projects/sent">
                   Sented Tasks 
                   
                 </a>
                 <a class="item" href="/users/<%= user._id%>/projects/new">
                   Sent New Tasks 
                   
                 </a>
               
                
               
             </div>
           </div>
           <div class="item">
             <div class=" header" id="showMails">
                 Mails
             
             </div>
             <div class="menu">
               
                 <a class="item" href="/users/<%= user._id%>/mails/received">
                   Received Mails
                   
                 </a>
               
                 <a class="item" href="/users/<%= user._id%>/mails/sent">
                   Sented Mails
                   
                 </a>
                 <a class="item" href="/users/<%= user._id%>/mails/sent/new">
                   Sent New Mail
                   
                 </a>
               
             </div>
           </div>
           
           
           
                   </div>
       </div>
       <style>
          .ui.grid > [class*="fourteen wide"].column {
   width: 85.3% !important;

}
#contentContainer {
   min-height: 962px;
   
}
       </style>
       <div class="fourteen wide column p-0 ml-4" >
         <div id="thirteen" class="thirteen wide stretched column p-0" >
           <div id="contentContainer" class="ui segment m-0 p-0" style="border: 0px">  -->

  <% user = currentUser%>
  <!--<div id="myDiv" data-test="<%=currentUser%>"></div>-->
  <script>
    
    const div = document.createElement("div");
      div.innerHTML = "<%=JSON.stringify(currentUser)%>";
      var currentUser = JSON.parse(div.textContent)
     // console.log(JSON.parse(div.textContent).admin);
       //console.log(JSON.parse(div.textContent)); 
   // alert(dat)
    //console.log(dat);
   // alert(user);
    //console.log("//"+currentUser._id)
  </script>
  <!-- <nav id="mainNavbar" class="navbar navbar-dark navbar-expand-sm py-0">
    <div class="container">
        <a id="navBrand" href="" class="navbar-brand">Brand</a>
        <button class="navbar-toggler" data-toggle="collapse" data-target="#navLinks">
        <span><i class="fas fa-angle-double-down"></i></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                <div class="dropdown my-0 py-0">
                    <button class="dropbtn ml-3 my-0 py-0">Units</button>
                    <div class="dropdown-content">-->

                      <!--//////////////////////-->
                        <!--<a class="dropdown-item" href="/orgchart/<%= currentUser._id%>">All Units</a>-->
                      <!--///////////////////////-->
                    <!--    <% units.forEach(function(unit){ %>
                          
                          <a class="dropdown-item" href="/orgchart/<%= currentUser._id%>/units/<%= unit._id%>"><%= unit.value%></a>
                        <% }); %>
                    </div>
                  </div>
             </ul>
             <ul class="navbar-nav navbar-right">
              <li class="nav-item">-->
                <!--//////////////////////-->
                <!--<a class="nav-link" href="/user/<%=currentUser._id%>/units/new">new Unit</a>-->
                <!--//////////////////////-->


              <!-- </li>
               <%if(!currentUser){%>-->


                <!--//////////////////////-->
              <!--<li class="nav-item">
                <a class="nav-link" href="register">Sign In</a>
               </li>-->
               <!--//////////////////////-->

               <!--<li class="nav-item">
                <a class="nav-link" href="login">Login</a>
               </li>
               <% }else{%>
                   <li class="nav-item mr-3">
                   <a class="nav-link" href="/users/<%= currentUser._id%>/profil" ><i class="fa fa-user" aria-hidden="true"></i>Profil</a>
                   </li>
                   <li class="nav-item">
                    <a class="nav-link" href="/logout">Logout</a>
                   </li>
                   <%}%>
             
              <li class="nav-item mr-3">
                <div class="notificationDropdown my-0 py-0">
                    <a class="nav-link"><i class="fas fa-comments"></i></a>
                    <div class="floating ui red label" style="top: 0em;"><span id="msgNotifsNumber"></span></div>
                    <div id="msgNotificationsContent" class="notificationDropdownContent">-->
                     
                     
                      <!--//////////////////////-->
                        <!-- nofications items -->
                        <!--//////////////////////-->



                    <!--</div>
                </div>
              </li>   
              <li class="nav-item mr-3">
                  <div class="notificationDropdown my-0 py-0">
                      <a class="nav-link"><i class="fas fa-envelope"></i></a>
                      <div class="floating ui red label" style="top: 0em;"><span id="mailNotifsNumber"></span></div>
                      <div id="mailNotificationsContent" class="notificationDropdownContent">-->

                          <!-- nofications items -->
                      <!--</div>
                  </div>
              </li>
              <li class="nav-item mr-3">
                  <div class="notificationDropdown my-0 py-0">
                      <a class="nav-link"><i class="fas fa-bell"></i></a>
                      <div class="floating ui red label" style="top: 0em;"><span id="bellNotifsNumber"></span></div>
                      <div id="bellNotificationsContent" class="notificationDropdownContent">-->

                          <!-- nofications items -->
                    <!--  </div>
                  </div>
              </li>
              
             </ul>
            
          </div>
    </div>
</nav> -->
<!--/////////////////////////////////////////////////////////////////////////////////////////////////////-->
<nav id="mainNavbar" class="navbar navbar-dark navbar-expand-sm py-0">
  <div class="container">
      <a id="navBrand" href="" class="navbar-brand">Brand</a>
      
      <button class="navbar-toggler" data-toggle="collapse" data-target="#navLinks">
      <span><i class="fas fa-angle-double-down"></i></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav mr-auto">
              <div class="dropdown my-0 py-0">
                  <button class="dropbtn my-1 ml-3">Units</button>
                  <div class="dropdown-content">
                      <a class="dropdown-item" href="/orgchart/<%= currentUser._id%>">All Units</a>
                      <% units.forEach(function(unit){ %>
                        <a class="dropdown-item" href="/orgchart/<%= currentUser._id%>/units/<%= unit._id%>"><%= unit.value%></a>
                      <% }) %>
                  </div>
                </div>
           </ul>
           <ul class="navbar-nav navbar-right">
                 <li class="nav-item mr-3">
                  <!-- <a class="nav-link" href="#"><i class="fa fa-user" aria-hidden="true"></i> Profil</a> -->
                 </li>
                 <%if(!currentUser){%>
                 <li class="nav-item">
                  <a class="nav-link" href="register">Sign In</a>
                 </li>
                 
                 <li class="nav-item">
                  <a class="nav-link" href="login">Login</a>
                 </li>
              <%}else{%>
                 <li class="nav-item">
                  <a class="nav-link" href="/logout">Logout</a>
                 </li>
                 <%}%>
              <li class="nav-item mr-3">
               <a class="nav-link" href="/users/<%= currentUser._id%>/profil"><i class="fa fa-user" aria-hidden="true"></i>Profil</a>
              </li>
              <li class="nav-item mr-3">
                  <div id="msgNotificationsDropdown" class="notificationDropdown my-0 py-0">
                      <a class="nav-link"><i class="fas fa-comments"></i></a>
                      <div class="floating ui red label" style="top: 0em;">
                          <span id="msgNotifsCount">
                              <%if(currentUser.messageNotifications.count > 0){%>
                                  <%=currentUser.messageNotifications.count%>
                              <%}%>
                          </span>
                      </div>
                      <div id="msgNotificationsContent" class="notificationDropdownContent">
                          <%if(currentUser.messageNotifications.array.length > 0){%>
                              <%currentUser.messageNotifications.array.forEach(function(notification){%>
                                  <%if(notification.count > 1){%>
                                      <a href="/users/<%=currentUser._id%>/contacts/<%=notification.senderId%>/chat"><strong class="bitraf mr-2"><i class="far fa-comment"></i></strong>You have received <strong class="bitraf" msgfrom="<%=notification.senderId%>"><%=notification.count%></strong> new private messages from <strong class="bitraf"><%=notification.senderUsername%></strong>.</a>
                                  <%}else{%>
                                      <a href="/users/<%=currentUser._id%>/contacts/<%=notification.senderId%>/chat"><strong class="bitraf mr-2"><i class="far fa-comment"></i></strong>You have received <strong class="bitraf" msgfrom="<%=notification.senderId%>">1</strong> new private message from <strong class="bitraf"><%=notification.senderUsername%></strong>.</a>
                                  <%}%>
                              <%});%>
                          <%}else{%>
                              <div id="msgEmptyNotifications" class="emptyNotifications">
                                  <span class="bitraf">Empty</span>
                              </div>
                          <%}%>
                      </div>
                  </div>
              </li>   
              <li class="nav-item mr-3">
                  <div id="mailNotificationsDropdown" class="notificationDropdown my-0 py-0">
                      <a class="nav-link"><i class="fas fa-envelope"></i></a>
                      <div class="floating ui red label" style="top: 0em;">
                          <span id="mailNotifsCount">
                              <%if(currentUser.mailNotifications.count > 0){%>
                                  <%=currentUser.mailNotifications.count%>
                              <%}%>
                          </span>
                      </div>
                      <div id="mailNotificationsContent" class="notificationDropdownContent">
                          <%if(currentUser.mailNotifications.array.length > 0){%>
                              <%currentUser.mailNotifications.array.forEach(function(notification){%>
                                  <%if(notification.notifType == 'newMail'){%>
                                      <%if(notification.count > 1){%>
                                          <a href="/users/<%=currentUser._id%>/mails/received"><strong class="bitraf mr-2"><i class="far fa-envelope"></i></strong>You have received <strong class="bitraf" mailfrom="<%=notification.senderId%>"><%=notification.count%></strong> new mails from <strong class="bitraf"><%=notification.senderUsername%></strong>.</a>
                                      <%}else{%>
                                          <a href="/users/<%=currentUser._id%>/mails/received/<%=notification.mailId%>/content"><strong class="bitraf mr-2"><i class="far fa-envelope"></i></strong>You have received <strong class="bitraf" mailfrom="<%=notification.senderId%>">1</strong> new mail from <strong class="bitraf"><%=notification.senderUsername%></strong>.</a>
                                      <%}%>
                                  <%}else if(notification.notifType == 'newReply'){%>
                                      <%if(notification.parentMailSender == user._id){%>
                                          <a href="/users/<%=currentUser._id%>/mails/received/<%=notification.replyId%>/content"><strong class="bitraf mr-2"><i class="far fa-envelope"></i></strong><strong class="bitraf"><%=notification.senderUsername%></strong> has replied to the sent mail <strong class="bitraf">"<%=notification.parentMailTitle%>"</strong>.</a>
                                      <%}else{%>
                                          <a href="/users/<%=currentUser._id%>/mails/received/<%=notification.replyId%>/content"><strong class="bitraf mr-2"><i class="far fa-envelope"></i></strong><strong class="bitraf"><%=notification.senderUsername%></strong> has replied to the received mail <strong class="bitraf">"<%=notification.parentMailTitle%>"</strong>.</a>
                                      <%}%>
                                  <%}else if(notification.notifType == 'mailSendFailed'){%>
                                      <%if(notification.senderId == user._id){%>
                                          <a><span class="bitraf mr-2"><i class="fas fa-exclamation-triangle"></i></span><strong class="bitraf"><%= notification.userThatDidNotReceiveUsername%></strong> was not able to receive your mail <strong class="bitraf">"<%= notification.mailTitle%>"</strong> due to his full storage.</a>
                                      <%}else{%>
                                          <a href="/users/<%=currentUser._id%>/mails/received"><span class="bitraf mr-2"><i class="fas fa-exclamation-triangle"></i></span> you were not able to receive a mail from <strong class="bitraf"><%=notification.senderUsername%></strong> at <strong class="bitraf">"<%=notification.at%>"</strong> due to your full storage.</a>
                                      <%}%>
                                  <%}else if(notification.notifType == 'notAbleToSendMailCuzFullSentMailsStorage'){%>
                                      <a href="/users/<%=currentUser._id%>/mails/sent"><span class="bitraf mr-2"><i class="fas fa-exclamation-triangle"></i></span> the mail <strong class="bitraf">"<%=notification.mailTitle%>"</strong> was not send due to your full sent mails storage.</a>
                                  <%}else if(notification.notifType == 'almostFullReceivedMailsStorage'){%>
                                      <a href="/users/<%=currentUser._id%>/mails/received"><span class="bitraf mr-2"><i class="fas fa-exclamation-triangle"></i></span> your received mails storage is almost full ,their is a risk of not being able to receive large mails in the future.</a>
                                  <%}else if(notification.notifType == 'almostFullSentMailsStorage'){%>
                                      <a href="/users/<%=currentUser._id%>/mails/sent"><span class="bitraf mr-2"><i class="fas fa-exclamation-triangle"></i></span> your sent mails storage is almost full ,their is a risk of not being able to send large mails in the future.</a>
                                  <%}%>
                              <%});%>
                          <%}else{%>
                              <div id="mailEmptyNotifications" class="emptyNotifications">
                                  <span class="bitraf">Empty</span>
                              </div>
                          <%}%>
                      </div>
                  </div>
              </li>
              <li class="nav-item mr-3">
                  <div id="bellNotificationsDropdown" class="notificationDropdown my-0 py-0">
                      <a class="nav-link"><i class="fas fa-bell"></i></a>
                      <div class="floating ui red label" style="top: 0em;">
                          <span id="bellNotifsCount">
                              <%if(currentUser.bellNotifications.count > 0){%>
                                  <%=currentUser.bellNotifications.count%>
                              <%}%>
                          </span>
                      </div>
                      <div id="bellNotificationsContent" class="notificationDropdownContent">
                          <%if(currentUser.bellNotifications.array.length > 0){%>
                              <%currentUser.bellNotifications.array.forEach(function(notification){%>
                                  <%if(notification.notifType == 'receivedProject'){%>
                                      <%if(notification.count > 1){%>
                                          <a href="/users/<%=currentUser._id%>/projects/received"><strong class="bitraf mr-2"><i class="fas fa-clipboard-list"></i></strong>You have received <strong class="bitraf" projectType="received"><%=notification.count%></strong> new projects.</a>
                                      <%}else{%>
                                          <a href="/users/<%=currentUser._id%>/projects/received/<%=notification.projectId%>/detail"><strong class="bitraf mr-2"><i class="fas fa-clipboard-list"></i></strong>You have received <strong class="bitraf" projectType="received">1</strong> new project at <strong class="bitraf"><%=notification.at%></strong>.</a>
                                      <%}%>
                                  <%}else if(notification.notifType == 'assignedProject'){%>
                                      <%if(notification.count > 1){%>
                                          <a href="/users/<%=currentUser%>/projects/assigned"><strong class="bitraf mr-2"><i class="fas fa-clipboard-list"></i></strong>You have been assigned to <strong class="bitraf" projectType="assigned"><%=notification.count%></strong> projects.</a>
                                      <%}else{%>
                                          <a href="/users/<%=currentUser%>/projects/assigned/<%=notification.projectId%>/detail"><strong class="bitraf mr-2"><i class="fas fa-clipboard-list"></i></strong>You have been assigned to <strong class="bitraf" projectType="received">1</strong> project at <strong class="bitraf"><%=notification.at%></strong>.</a>
                                      <%}%>
                                  <%}else if(notification.notifType == 'updateProject'){%>
                                      <%if(notification.projectType == 'assigned'){%>
                                          <a href="/users/<%=currentUser%>/projects/assigned/<%=notification.projectId%>/detail"><strong class="bitraf mr-2"><i class="fas fa-exclamation-circle"></i></strong> <strong class="bitraf"><%=notification.username%></strong> has updated the project <strong class="bitraf">"<%=notification.projectTitle%>"</strong> at <strong class="bitraf"><%=notification.at%></strong>.</a>
                                      <%}else{%>
                                          <a href="/users/<%=currentUser%>/projects/received/<%=notification.projectId%>/detail"><strong class="bitraf mr-2"><i class="fas fa-exclamation-circle"></i></strong> <strong class="bitraf"><%=notification.username%></strong> has updated the project <strong class="bitraf">"<%=notification.projectTitle%>"</strong> at <strong class="bitraf"><%=notification.at%></strong>.</a>
                                      <%}%>
                                  <%}else if(notification.notifType == 'unassignProject'){%>
                                      <a><strong class="bitraf mr-2"><i class="fas fa-exclamation-circle"></i></strong> <strong class="bitraf"><%=notification.username%></strong> has unassigned the project <strong class="bitraf">"<%=notification.projectTitle%>"</strong> at <strong class="bitraf"><%=notification.at%></strong>.</a>
                                  <%}else if(notification.notifType == 'newEvent'){%>
                                      <%if(notification.count > 1){%>
                                          <a href="/users/<%=currentUser._id%>/events"><strong class="bitraf mr-2"><i class="far fa-star"></i></strong> <strong class="bitraf"><%=notification.plannerUsername%></strong> has planned <span class="bitraf" eventFrom="<%=notification.plannerId%>"><%=notification.count%></span> events for you.</a>
                                      <%}else{%>
                                          <a href="<%=notification.url%>"><strong class="bitraf mr-2"><i class="far fa-star"></i></strong> <strong class="bitraf"><%=notification.plannerUsername%></strong> has planned <span class="bitraf" eventFrom="<%=notification.plannerId%>">1</span> event <strong class="bitraf">"<%=notification.eventTitle%>"</strong> for you at <strong class="bitraf"><%=notification.at%></strong>.</a>
                                      <%}%>
                                  <%}else if(notification.notifType == 'eventUpdate'){%>
                                      <a href="<%=notification.url%>"><strong class="bitraf mr-2"><i class="fas fa-exclamation-circle"></i></strong> <strong class="bitraf"><%=notification.plannerUsername%></strong> has updated <strong class="bitraf">"<%=notification.eventTitle%>"</strong> at <strong class="bitraf"><%=notification.at%></strong>.</a>
                                  <%}else if(notification.notifType == 'eventCancellation'){%>
                                      <a><strong class="bitraf mr-2"><i class="fas fa-exclamation-circle"></i></strong> <strong class="bitraf"><%=notification.plannerUsername%></strong> has canceled your <strong class="bitraf">"<%=notification.eventTitle%>"</strong> at <strong class="bitraf"><%=notification.at%></strong>.</a>
                                  <%}else if(notification.notifType == 'projectDiscussion'){%>
                                      <%if(notification.count > 1){%>
                                          <a href="/users/<%=user._id%>/projects/<%=notification.projectType%>/<%=notification.projectId%>/discussion"><strong class="bitraf mr-2"><i class="far fa-comments"></i></strong> <strong class="bitraf" discussionOf="<%=notification.projectId%>"><%=notification.count%></strong> new messages in <strong class="bitraf"><%=notification.projectTitle%></strong>'s group discussion.</a>
                                      <%}else{%>
                                          <a href="/users/<%=user._id%>/projects/<%=notification.projectType%>/<%=notification.projectId%>/discussion"><strong class="bitraf mr-2"><i class="far fa-comments"></i></strong> <strong class="bitraf" discussionOf="<%=notification.projectId%>">1</strong> new message in <strong class="bitraf"><%=notification.projectTitle%></strong>'s group discussion.</a>
                                      <%}%>
                                  <%}%>
                              <%});%>
                          <%}else{%>
                              <div id="bellEmptyNotifications" class="emptyNotifications">
                                  <span class="bitraf">Empty</span>
                              </div>
                          <%}%>
                      </div>
                  </div>
              </li>
             
           </ul>
        </div>
  </div>
</nav>
<div class="ui top attached menu mt-0">
  <a class="item">
    <i class="sidebar icon"></i> Menu
  </a>
</div>
<div class="ui bottom attached segment">
  <div class="ui inverted labeled icon left inline vertical demo sidebar menu">
    
    
    
    
    
    <div class="item">
              
      <a ><b>Society Name</b></a>
      
    </div>
  
 
  
  <a class="item " href="/orgchart/<%= currentUser._id%>">
    <b>Organigram</b>
  </a>
 
  <div class="item">
    <div class="header">
      
        Profil
      
    </div>
    <div class="menu" id="showProfil">
      <a  class="item" href="/users/<%= user._id%>/profil">
        Show Profil
      </a>
      <%if(currentUser && currentUser.admin===true){%>
        <a class="item" href="/users/<%= currentUser._id%>/units">
          Units Management
        </a>
      
        <a class="item" href="/users/<%= currentUser._id%>/profil/gestionUsers">
          Users Management
        </a>
      <%}%>
    </div>
  </div>
  <%if(currentUser && user._id.equals(currentUser._id)){%>
  <div class="item">
    <div class=" header">
      
      Contacts

    </div>
    <div class="menu" id="showContacts">
      
        <a class="item"  href="/users/<%= user._id%>/contacts">
          show Contacts
          
        </a>
      
    </div>
  </div>
  <%}%>
  <div class="item">
    <div class="header">
      
        Calendar
    </div>
    <div class="menu" id="showCalendar">
      
        <a class="item"   href="/users/<%= user._id%>/events/calendar">
         Show Calendar
          
        </a>
      
        <a class="item"  href="/users/<%= user._id%>/events/planned">
          Planned Events
          
        </a>
      
    </div>
  </div>
  <%if(currentUser && user._id.equals(currentUser._id)){%>
  <div class="item">
    <div class=" header" id="showProjects" >

        Tasks
    
    </div>
    <div class="menu">
      
        <a class="item" href="/users/<%= user._id%>/projects/received">
          Received Tasks
          
        </a>
      
        <a class="item" href="/users/<%= user._id%>/projects/assigned">
          Assigned Tasks
          
        </a>
        <% function isLeaf(){
          Leaf = true;
          
         allUsers.forEach(user=>{
           if(currentUser._id.equals(user.parentId)){
              Leaf = false;
             return Leaf;
             }
             
           })
           return Leaf;
         }%>
           
          <%if(isLeaf()=== false){ %>
        <a class="item" href="/users/<%= user._id%>/projects/sent">
          Sented Tasks 
          
        </a>
        <a class="item" href="/users/<%= user._id%>/projects/new">
          Sent New Tasks 
          
        </a>
      <%}%>
       
      
    </div>
  </div>
  <div class="item">
    <div class=" header" id="showMails">
        Mails
    
    </div>
    <div class="menu">
      
        <a class="item" href="/users/<%= user._id%>/mails/received">
          Received Mails
          
        </a>
      
        <a class="item" href="/users/<%= user._id%>/mails/sent">
          Sented Mails
          
        </a>
        <a class="item" href="/users/<%= user._id%>/mails/sent/new">
          Sent New Mail
          
        </a>
      
    </div>



  </div>
  <%}%>
  <div class="pusher">
     <div class="ui basic segment">
     
   
    </div> 
  </div>
</div>
<!--////////////////////////////////////////////////////////////////////////////////////////////////////////-->
<div id="sample">
  <div id="myDiagramDiv" style="background-color: #34343C; border: solid 1px black; height: 570px;"></div>
  
  <script>
    //document.getElementsBy("table").classList.add("table");
  </script>
  <button id="zoomToFit" class="btn btn-outline-success pr-4 pl-4" >Zoom to Fit</button> <button id="centerRoot" class="btn btn-outline-success">Center on root</button>
  <div>
    
    <div id="myInspector" >
    </div>
  </div>
  
  <!--<p>
    This editable organizational chart sample color-codes the Nodes according to the tree level in the hierarchy.
  </p>
  <p>
    Double click on a node in order to add a person or the diagram background to add a new boss. Double clicking the diagram uses the <a>ClickCreatingTool</a>
    with a custom <a>ClickCreatingTool.insertPart</a> to scroll to the new node and start editing the <a>TextBlock</a> for its name .
  </p>
  <p>
    Drag a node onto another in order to change relationships.
    You can also draw a link from a node's background to other nodes that have no "boss". Links can also be relinked to change relationships.
    Right-click or tap-hold a Node to bring up a context menu which allows you to:
    <ul>
      <li>Vacate Position - remove the information specfic to the current person in that role</li>
      <li>Remove Role - removes the role entirely and reparents any children</li>
      <li>Remove Department - removes the role and the whole subtree</li>
    </ul>
    Deleting a Node or Link will orphan the child Nodes and generate a new tree. A custom SelectionDeleting <a>DiagramEvent</a> listener will clear out the boss info
    when the parent is removed.
  </p>
  <p>
    Select a node to edit/update node data values. This sample uses the <a href="../extensions/DataInspector.html">Data Inspector</a> extension to display and modify Part data.
  </p>
  <p>
    To learn how to build an org chart from scratch with GoJS, see the <a href="../learn/index.html">Getting Started tutorial</a>.
  </p>
  <p>
    If you want to have some "assistant" nodes on the side, above the regular reports,
    see the <a href="orgChartAssistants.html">Org Chart Assistants</a> sample, which is a copy of this sample
    that uses a custom <a>TreeLayout</a> to position "assistants" that way.
  </p>-->
  <div>
    <%console.log(A)%>
    
    <%if(A===0){%>
    <div>
        <form action="/orgchart/<%= currentUser.id%>" method="POST"> 
          <%if(currentUser.admin===true){%>
            <button id="SaveButton" class="btn btn-success" onclick="save()" type="submit">Save</button>
            <%}%>
            <%if(currentUser.admin===true){%>
              Diagram Model saved in JSON format:
              <textarea name="dat" id="mySavedModel" class="form-control" style="width:100%; height:270px;">
                  {"class": "go.TreeModel","nodeDataArray":<%=dataa%>}
                      </textarea>
              <%}else{%>
                
                <textarea name="dat" id="mySavedModel" class="form-control" style="width:100%; height:270px; display: none;">
                    {"class": "go.TreeModel","nodeDataArray":<%=dataa%>}
                        </textarea>
                <%}%>
            
        </form>
        <%if(currentUser.admin===true){%>
        <button class="btn btn-outline-success" onclick="load()">Load</button>
        <%}%>
    </div>
    <%}else{%>
      <div>
        <form action="/orgchart/<%= currentUser.id%>/units/<%=unit._id%>" method="POST"> 
          <%if(currentUser.admin===true){%>
            <button id="SaveButton" class="btn btn-outline-success" onclick="save()" type="submit">Save units</button>
            <%}%>
            <%if(currentUser.admin===true){%>
              Diagram Model saved in JSON format:
              <textarea name="dat" id="mySavedModel" class="form-control" style="width:100%; height:270px;">
                  {"class": "go.TreeModel","nodeDataArray":<%=dataa%>}
                      </textarea>
              <%}else{%>
                
            <textarea name="dat" id="mySavedModel" class="form-control" style="width:100%; height:270px; display: none;">
                {"class": "go.TreeModel","nodeDataArray":<%=dataa%>}
                    </textarea>
                <%}%>
            
        </form>
        <%if(currentUser.admin===true){%>
        <button class="btn btn-outline-success" onclick="load()">Load</button>
        <%}%>
    </div>
 <% }%>

<!--
{"key":1, "name":"Stella Payne Diaz", "title":"CEO"},
{"key":2, "name":"Luke Warm", "title":"VP Marketing/Sales", "parent":1},
{"key":3, "name":"Meg Meehan Hoffa", "title":"Sales", "parent":2},
{"key":4, "name":"Peggy Flaming", "title":"VP Engineering", "parent":1},
{"key":5, "name":"Saul Wellingood", "title":"Manufacturing", "parent":4},
{"key":6, "name":"Al Ligori", "title":"Marketing", "parent":2},
{"key":7, "name":"Dot Stubadd", "title":"Sales Rep", "parent":3},
{"key":8, "name":"Les Ismore", "title":"Project Mgr", "parent":5},
{"key":9, "name":"April Lynn Parris", "title":"Events Mgr", "parent":6},
{"key":10, "name":"Xavier Breath", "title":"Engineering", "parent":4},
{"key":11, "name":"Anita Hammer", "title":"Process", "parent":5},
{"key":12, "name":"Billy Aiken", "title":"Software", "parent":10},
{"key":13, "name":"Stan Wellback", "title":"Testing", "parent":10},
{"key":14, "name":"Marge Innovera", "title":"Hardware", "parent":10},
{"key":15, "name":"Evan Elpus", "title":"Quality", "parent":5},
{"key":16, "name":"Lotta B. Essen", "title":"Sales Rep", "parent":3}-->
  


<!-- </div>
</div> -->


</div>
        
</div>
 
  
  
  
  
  
  </div>
</div>
</div>
</div>


<!-- SCRIPTS -->
<script>
  $('.ui.sidebar').sidebar({
    context: $('.bottom.segment')
  })
  .sidebar('attach events', '.menu .item');

  /*  function sideT(){
    $('.ui.sidebar').sidebar('attach events', '.top.ui.menu .item.sidebar');
  }
  window.onload = function(){
    document.getElementsByClassName("view-ui").onclick = function sideT2(){
      sideT();
    }
  }  */ 
    
    
   
$('.ui.accordion')
  .accordion()
;
$('.trigger.example .accordion')
  .accordion({
    selector: {
      trigger: '.title .icon'
    }
  })
;
  
</script>
<script type="text/javascript" src="/scripts/lib/jquery-3.4.1.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/components/dropdown.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery/latest/jquery.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/@editorjs/header@latest"></script><!-- Header -->
<script src="https://cdn.jsdelivr.net/npm/@editorjs/simple-image@latest"></script><!-- Image -->
<script src="https://cdn.jsdelivr.net/npm/@editorjs/delimiter@latest"></script><!-- Delimiter -->
<script src="https://cdn.jsdelivr.net/npm/@editorjs/list@latest"></script><!-- List -->
<script src="https://cdn.jsdelivr.net/npm/@editorjs/checklist@latest"></script><!-- Checklist -->
<script src="https://cdn.jsdelivr.net/npm/@editorjs/quote@latest"></script><!-- Quote -->
<script src="https://cdn.jsdelivr.net/npm/@editorjs/code@latest"></script><!-- Code -->
<script src="https://cdn.jsdelivr.net/npm/@editorjs/embed@latest"></script><!-- Embed -->
<script src="https://cdn.jsdelivr.net/npm/@editorjs/table@latest"></script><!-- Table -->
<script src="https://cdn.jsdelivr.net/npm/@editorjs/link@latest"></script><!-- Link -->
<script src="https://cdn.jsdelivr.net/npm/@editorjs/warning@latest"></script><!-- Warning -->
<script src="https://cdn.jsdelivr.net/npm/@editorjs/marker@latest"></script><!-- Marker -->
<script src="https://cdn.jsdelivr.net/npm/@editorjs/inline-code@latest"></script><!-- Inline Code -->

<script src="/socket.io/socket.io.js"></script>
<script src='/scripts/socket-io.js'></script>

<script src="/scripts/editor.js"></script>
<script src='/scripts/profil.js'></script>
</body>

</html>